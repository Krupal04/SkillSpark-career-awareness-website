<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | SkillsSpark</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
  background:#eef1f4;
  font-family:'Poppins',sans-serif;
}
.card{
  border-radius:18px;
  padding:30px;
  box-shadow:0 8px 25px rgba(0,0,0,0.12);
}
.input-field{
  height:48px;
  border-radius:10px;
}
.toggle{
  color:#0d6efd;
  cursor:pointer;
  font-weight:500;
}
</style>
</head>

<body>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-5">
      <div class="card">

        <h3 class="text-center fw-bold mb-4">SkillsSpark</h3>

        <!-- LOGIN -->
        <form id="loginForm">
          <input id="loginEmail" type="email" class="form-control input-field mb-2"
                 placeholder="Email" autocomplete="off" required>
          <input id="loginPassword" type="password" class="form-control input-field mb-3"
                 placeholder="Password" autocomplete="new-password" required>
          <button class="btn btn-primary w-100 mb-3">Login</button>
          <p class="text-center">
            New user? <span class="toggle" id="showSignup">Sign Up</span>
          </p>
        </form>

        <!-- SIGNUP -->
        <form id="signupForm" style="display:none;">
          <input id="signupName" type="text" class="form-control input-field mb-2"
                 placeholder="Full Name" autocomplete="off" required>
          <input id="signupEmail" type="email" class="form-control input-field mb-2"
                 placeholder="Email" autocomplete="off" required>
          <input id="signupPassword" type="password" class="form-control input-field mb-3"
                 placeholder="Password" autocomplete="new-password" required>
          <button class="btn btn-success w-100 mb-3">Create Account</button>
          <p class="text-center">
            Already registered? <span class="toggle" id="showLogin">Login</span>
          </p>
        </form>

        <div id="msg" class="text-center mt-2"></div>

      </div>
    </div>
  </div>
</div>

<script>
/* ðŸ”¥ AUTO RESET LOGIN DATA (RUNS ONCE) */
if(!localStorage.getItem("ss_reset_done")){
  localStorage.removeItem("ss_users");
  localStorage.removeItem("ss_current");
  localStorage.setItem("ss_reset_done","yes");
}

/* ELEMENTS */
const loginForm = document.getElementById("loginForm");
const signupForm = document.getElementById("signupForm");
const msg = document.getElementById("msg");

/* TOGGLE */
document.getElementById("showSignup").onclick = ()=>{
  loginForm.style.display="none";
  signupForm.style.display="block";
  msg.textContent="";
};
document.getElementById("showLogin").onclick = ()=>{
  signupForm.style.display="none";
  loginForm.style.display="block";
  msg.textContent="";
};

/* STORAGE HELPERS */
function getUsers(){
  return JSON.parse(localStorage.getItem("ss_users") || "{}");
}
function saveUsers(users){
  localStorage.setItem("ss_users", JSON.stringify(users));
}
function showMsg(text, error=false){
  msg.textContent = text;
  msg.className = error ? "text-danger" : "text-success";
}

/* SIGNUP */
signupForm.onsubmit = e=>{
  e.preventDefault();
  const users = getUsers();
  const email = signupEmail.value.trim();

  if(users[email]){
    showMsg("User already exists", true);
    return;
  }

  users[email] = {
    name: signupName.value.trim(),
    password: signupPassword.value
  };

  saveUsers(users);
  localStorage.setItem("ss_current", email);
  showMsg("Account created successfully");
  setTimeout(()=>location.href="profile.html",700);
};

/* LOGIN */
loginForm.onsubmit = e=>{
  e.preventDefault();
  const users = getUsers();
  const email = loginEmail.value.trim();
  const pass = loginPassword.value;

  if(!users[email] || users[email].password !== pass){
    showMsg("Invalid email or password", true);
    return;
  }

  localStorage.setItem("ss_current", email);
  showMsg("Login successful");
  setTimeout(()=>location.href="profile.html",600);
};

/* CLEAR INPUTS */
window.onload = ()=>{
  loginEmail.value="";
  loginPassword.value="";
};
</script>

</body>
</html>
